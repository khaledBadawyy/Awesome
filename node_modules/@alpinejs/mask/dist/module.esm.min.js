function x(n){n.directive("mask",(e,{value:t,expression:u},{effect:s,evaluateLater:a,cleanup:r})=>{let l=()=>u,i="";queueMicrotask(()=>{if(["function","dynamic"].includes(t)){let o=a(u);s(()=>{l=p=>{let g;return n.dontAutoEvaluateFunctions(()=>{o(c=>{g=typeof c=="function"?c(p):c},{scope:{$input:p,$money:m.bind({el:e})}})}),g},f(e,!1)})}else f(e,!1);e._x_model&&e._x_model.set(e.value)});let d=new AbortController;r(()=>{d.abort()}),e.addEventListener("input",()=>f(e),{signal:d.signal,capture:!0}),e.addEventListener("blur",()=>f(e,!1),{signal:d.signal});function f(o,p=!0){let g=o.value,c=l(g);if(!c||c==="false")return!1;if(i.length-o.value.length===1)return i=o.value;let v=()=>{i=o.value=h(g,c)};p?I(o,c,()=>{v()}):v()}function h(o,p){if(o==="")return"";let g=b(p,o);return k(p,g)}}).before("model")}function I(n,e,t){let u=n.selectionStart,s=n.value;t();let a=s.slice(0,u),r=k(e,b(e,a)).length;n.setSelectionRange(r,r)}function b(n,e){let t=e,u="",s={9:/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},a="";for(let r=0;r<n.length;r++){if(["9","a","*"].includes(n[r])){a+=n[r];continue}for(let l=0;l<t.length;l++)if(t[l]===n[r]){t=t.slice(0,l)+t.slice(l+1);break}}for(let r=0;r<a.length;r++){let l=!1;for(let i=0;i<t.length;i++)if(s[a[r]].test(t[i])){u+=t[i],t=t.slice(0,i)+t.slice(i+1),l=!0;break}if(!l)break}return u}function k(n,e){let t=Array.from(e),u="";for(let s=0;s<n.length;s++){if(!["9","a","*"].includes(n[s])){u+=n[s];continue}if(t.length===0)break;u+=t.shift()}return u}function m(n,e=".",t,u=2){if(n==="-")return"-";if(/^\D+$/.test(n))return"9";t==null&&(t=e===","?".":",");let s=(i,d)=>{let f="",h=0;for(let o=i.length-1;o>=0;o--)i[o]!==d&&(h===3?(f=i[o]+d+f,h=0):f=i[o]+f,h++);return f},a=n.startsWith("-")?"-":"",r=n.replaceAll(new RegExp(`[^0-9\\${e}]`,"g"),""),l=Array.from({length:r.split(e)[0].length}).fill("9").join("");return l=`${a}${s(l,t)}`,u>0&&n.includes(e)&&(l+=`${e}`+"9".repeat(u)),queueMicrotask(()=>{this.el.value.endsWith(e)||this.el.value[this.el.selectionStart-1]===e&&this.el.setSelectionRange(this.el.selectionStart-1,this.el.selectionStart-1)}),l}var $=x;export{$ as default,x as mask,b as stripDown};
